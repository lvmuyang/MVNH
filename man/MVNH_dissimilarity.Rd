\name{MVNH_dissimilarity}
\alias{MVNH_dissimilarity}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{MVNH_dissimilarity
%%  ~~function to do ... ~~
}
\description{
This function calculates the dissimilarity metric between a pair of multivariate normal hypervolumes, as well as the partitioned centroid distance and determinant ratio components.
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
MVNH_dissimilarity(db1,db2,mean1,mean2,cov1,cov2,
                   metric,var.names,cov.matrix)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{db1,db2}{ Datasets with rows as observations and columns as variables. The order matters only with the "MacArthur-Levin" metric which compares db2 against db1. Not used when cov.matrix=T.}
  \item{cov.matrix}{ Logical value, the default is False. To supply covariance matrices and mean values instead of datasets for calculation.}
  \item{mean1,mean2}{ means of hypervolumes supplied by user rather than calculated from the datasets. Should be vectors of length(variables). Used only when cov.matrix=T.}
  \item{cov1,cov2}{ The covariance matrices supplied for the calculation. Used only when cov.matrix is TRUE.}
  \item{metric}{ Metrics used to calculate the dissimilarity. The default is the "Bhattacharyya_distance". Other available options are "MacArthur-Levins","Pianka","Morisita". Note that Morisita distance does not provide a paritioning for the determinant ratio component, and "MacArthur-Levins" is an asymmetric measure.}
  \item{var.names}{ Names of the variables provided by user. The default is NULL, which takes the column names of the matrix or the dataset, or use 'variable1', 'variable2'... when no names are associated with the data.}
%%     ~~Describe \code{x} here~~
}

\value{
\item{Mahalanobis_distance}{The Mahalanobis distance component of the total dissimilarity of the Bhattacharyya distance, Pianka's metric etc.}
\item{Determinant_ratio}{The determinant ratio component of the total dissimilarity of the Bhattacharyya distance, Pianka's metric etc.}
\item{total}{The total dissimilarity of the returned item.}
\item{variable i}{The dissimilarity of variable i.}
\item{cor}{The correlation component which is the total dissimilarity subtracted by the sum of all univariate dissimilarity.}
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
Lu, M., Winner, K., & Jetz, W. (2020). A unifying framework for quantifying and comparing n-dimensional hypervolumes. BioRxiv. https://doi.org/10.1101/2020.11.21.392696
}
\author{
Muyang Lu (muyang.lu@yale.edu), Kevin Winner, Walter Jetz
%%  ~~who you are~~
}
\note{
When the covariance matrix is singular (high collinearity), the metric is not reliable because the determinant will aprroximate 0.
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\examples{
## two multivariate normal distributions as toy example
library(MASS)
# db1 for dataframe1 db2 for dataframe2
# two random matrixes generated by 2 mutivariate normal distributions
db1 = mvrnorm(n=50,mu=c(1,1),Sigma=matrix(c(1,0,0,1),nrow=2))
db2 = mvrnorm(n=50,mu=c(2,2),Sigma=matrix(c(2,0.6,0.6,0.5),nrow=2))
MVNH_dissimilarity(db1,db2)

# or directly supply the means and covariance matrices
MVNH_dissimilarity(mean1=c(1,1),mean2=c(2,2),
  cov1=matrix(c(1,0,0,1),nrow=2),cov2=matrix(c(2,0.6,0.6,0.5),nrow=2),
  cov.matrix=TRUE)
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory (show via RShowDoc("KEYWORDS")):
% \keyword{ ~kwd1 }
% \keyword{ ~kwd2 }
% Use only one keyword per line.
% For non-standard keywords, use \concept instead of \keyword:
% \concept{ ~cpt1 }
% \concept{ ~cpt2 }
% Use only one concept per line.
